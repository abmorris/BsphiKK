<RapidFit>
	<ParameterSet>
	  // Magnitudes squared
    <PhysicsParameter>
      <Name>ASzero2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APminus2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APzero2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APplus2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADminus2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADzero2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADplus2</Name>
      <Value>100</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1000.0</Maximum>
      <Type>Free</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    // Phases
    <PhysicsParameter>
      <Name>deltaSzero</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPminus</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPzero</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPplus</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDminus</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDzero</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDplus</Name>
      <Value>0.3</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
  </ParameterSet>
  // Choose the minimiser
  <Minimiser>
    <MinimiserName>Minuit</MinimiserName>
    <MaxSteps>100</MaxSteps>
  </Minimiser>
  // Choose the fit function
  <FitFunction>
    <FunctionName>NegativeLogLikelihoodThreaded</FunctionName>
    <Threads>8</Threads>
    <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
    <FixedIntegrationPoints>100000</FixedIntegrationPoints>
	  <SetIntegratorTest>True</SetIntegratorTest>
  </FitFunction>
	<ToFit>
    // Choose the PDF
	  <PDF>
		  <Name>Bs2PhiKKTotal</Name>
    </PDF>
		<DataSet>
			<Source>File</Source>
			<FileName>/afs/cern.ch/work/a/admorris/BsphiKK/ntuples/BsphiKK_data_mva.root</FileName>
			<CutString>mlp>0.62</CutString>
			<NTuplePath>DecayTree</NTuplePath>
			<NumberEvents>1000000</NumberEvents>
			<PhaseSpaceBoundary>
        <Observable>
          <Name>mKK</Name>
          <TF1>KK_M</TF1>
          <Minimum>980</Minimum>
          <Maximum>1800</Maximum>
          <Unit>MeV/c^{2}</Unit>
        </Observable>
	      <Observable>
		      <Name>phi</Name>
   				<TF1>Phi_angle</TF1>
		      <Minimum>-3.14159</Minimum>
		      <Maximum>3.14159</Maximum>
		      <Unit>rad</Unit>
	      </Observable>
	      <Observable>
		      <Name>ctheta_1</Name>
   				<TF1>cos_theta1</TF1>
		      <Minimum>-1.0</Minimum>
		      <Maximum>1.0</Maximum>
		      <Unit>Unitless</Unit>
	      </Observable>
	      <Observable>
		      <Name>ctheta_2</Name>
   				<TF1>cos_theta2</TF1>
		      <Minimum>-1.0</Minimum>
		      <Maximum>1.0</Maximum>
		      <Unit>Unitless</Unit>
	      </Observable>
      </PhaseSpaceBoundary>
		</DataSet>
	</ToFit>
	<Output>
    <ComponentProjection>
      <Name>mKK</Name>
      <DrawPull>True</DrawPull>
    </ComponentProjection>
    <ComponentProjection>
      <Name>phi</Name>
      <DrawPull>True</DrawPull>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_1</Name>
      <DrawPull>True</DrawPull>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_2</Name>
      <DrawPull>True</DrawPull>
    </ComponentProjection>
  </Output>
</RapidFit>
