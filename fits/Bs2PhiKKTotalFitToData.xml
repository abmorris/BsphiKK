<RapidFit>
	<ParameterSet>
    <PhysicsParameter>
      <Name>SignalFraction</Name>
      <Value>0.9999990</Value>
      <Maximum>0.99999999990</Maximum>
      <Minimum>0.99999999000</Minimum>
      <Type>Float</Type>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>A</Name>
      <Value>1.97009</Value>
      <Type>Fixed</Type>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>B</Name>
      <Value>-3.50295</Value>
      <Type>Fixed</Type>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>C</Name>
      <Value>10.3624</Value>
      <Type>Fixed</Type>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>M</Name>
      <Value>986.115</Value>
      <Type>Fixed</Type>
    </PhysicsParameter>
	  // Magnitudes squared
    <PhysicsParameter>
      <Name>ANonRes2</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ASzero2</Name>
      <Value>1.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APminus2</Name>
      <Value>0.3175</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APzero2</Name>
      <Value>0.365</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APplus2</Name>
      <Value>0.3175</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADminus2</Name>
      <Value>0.09</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADzero2</Name>
      <Value>0.09</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADplus2</Name>
      <Value>0.09</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    // Phases
    <PhysicsParameter>
      <Name>deltaSzero</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPminus</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPzero</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPplus</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDminus</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDzero</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDplus</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
  </ParameterSet>
  // Choose the minimiser
  <Minimiser>
    <MinimiserName>Minuit</MinimiserName>
  </Minimiser>
  // Choose the fit function
  <FitFunction>
    <FunctionName>NegativeLogLikelihoodNumerical</FunctionName>
    <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
    <FixedIntegrationPoints>10000</FixedIntegrationPoints>
    <Threads>16</Threads>
  </FitFunction>
  <CommonPhaseSpace>
	  <PhaseSpaceBoundary>
      <Observable>
        <Name>mKK</Name>
        <TF1>BCON_KK_M</TF1>
        <Minimum>988</Minimum>
        <Maximum>1800</Maximum>
        <Unit>MeV/c^{2}</Unit>
      </Observable>
      <Observable>
        <Name>phi</Name>
		    <TF1>Phi_angle</TF1>
        <Minimum>-3.14159</Minimum>
        <Maximum>3.14159</Maximum>
        <Unit>rad</Unit>
      </Observable>
      <Observable>
        <Name>ctheta_1</Name>
		    <TF1>cos_theta1</TF1>
        <Minimum>-1.0</Minimum>
        <Maximum>1.0</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ctheta_2</Name>
		    <TF1>cos_theta2</TF1>
        <Minimum>-1.0</Minimum>
        <Maximum>1.0</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>mphiKK</Name>
        <TF1>B_s0_LOKI_Mass</TF1>
        <Minimum>5326.12</Minimum>
        <Maximum>5406.56</Maximum>
        <Unit>MeV/c^{2}</Unit>
      </Observable>
      <Observable>
        <Name>ReFSzero</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFPminus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ImFPminus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFPzero</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFPplus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ImFPplus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFDminus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ImFDminus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFDzero</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ReFDplus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ImFDplus</Name>
        <Minimum>-1</Minimum>
        <Maximum>1</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
    </PhaseSpaceBoundary>
  </CommonPhaseSpace>
  
	<ToFit>
    // Choose the PDF
    <SumPDF>
    	<PDF>
		    <Name>Bs2PhiKKTotal</Name>
		    <ConfigurationParameter>CoefficientsFile:LegendreMoments_Acceptance.root</ConfigurationParameter>
      </PDF>
    	<PDF>
		    <Name>Bs2PhiKKBackground</Name>
		    <ConfigurationParameter>CoefficientsFile:LegendreMoments_Background.root</ConfigurationParameter>
      </PDF>
      <FractionName>SignalFraction</FractionName>
    </SumPDF>
		<DataSet>
			<Source>File</Source>
			<FileName>/afs/cern.ch/work/a/admorris/BsphiKK/ntuples/BsphiKK_data_1800_mvacut.root</FileName>
//			<CutString>mlp>0.62</CutString>
			<NTuplePath>DecayTree</NTuplePath>
			<NumberEvents>10000</NumberEvents>
			<CommonPhaseSpace>
			</CommonPhaseSpace>
		</DataSet>
	</ToFit>
	<Output>
    <ComponentProjection>
      <Name>mKK</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>1000</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>False</DrawPull>
      <Ymax>100</Ymax>
      <Ymin>-10</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>phi</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>1000</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>False</DrawPull>
      <Ymin>0</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_1</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>1000</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>False</DrawPull>
      <Ymin>0</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_2</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>1000</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>False</DrawPull>
      <Ymin>0</Ymin>
    </ComponentProjection>
  </Output>
</RapidFit>
