<RapidFit>

	//================================================
	// Formal Parameters to be fitted or fixed

	<ParameterSet>
		
		<PhysicsParameter>
		<Name>SignalFraction</Name>
		<Value>0.8314</Value>
		<Minimum>0.0</Minimum>
		<Maximum>1.0</Maximum>
		<Type>Free</Type>
		<Unit>Unitless</Unit>
		</PhysicsParameter>

		<PhysicsParameter>
		<Name>alphaM_pr</Name>
		<Value>0.000535</Value>
		<Type>Free</Type>
		<Unit>Unitless</Unit>
		</PhysicsParameter>
	
		<PhysicsParameter>
		<Name>f_sig_m1</Name>
		<Value>0.804</Value>
		<Minimum>0.</Minimum>
		<Maximum>1.0</Maximum>
		<Type>Free</Type>
		<Unit>Unitless</Unit>
		</PhysicsParameter>

		<PhysicsParameter>
		<Name>sigma_m1</Name>
		<Value>8.11</Value>
		<Minimum>0.0</Minimum>
		<Maximum>10.0</Maximum>
		<Type>Free</Type>
		<Unit>MeV/c^{2}</Unit>
		</PhysicsParameter>
				
		<PhysicsParameter>
		<Name>ratio_21</Name>
		<Value>2.22</Value>
		<Minimum>0.0</Minimum>
		<Maximum>10.0</Maximum>
		<Type>Free</Type>
		<Unit>MeV/c^{2}</Unit>
		</PhysicsParameter>

		<PhysicsParameter>
		<Name>m_Bs</Name>
		<Value>5368.21</Value>
		<Type>Free</Type>
		<Unit>MeV/c^{2}</Unit>
		</PhysicsParameter>

	</ParameterSet>


	//==========================================
	// Specify which minimiser to use.

	<Minimiser>
		<MinimiserName>Minuit</MinimiserName>
		<MaxSteps>100000</MaxSteps>
		<GradTolerance>0.0001</GradTolerance>
		<Quality>1</Quality>
	</Minimiser>

	<FitFunction>
	<FunctionName>NegativeLogLikelihoodThreaded</FunctionName>
	<Threads>16</Threads>
	<SetIntegratorTest>False</SetIntegratorTest>
	</FitFunction>

	<NumberRepeats>1</NumberRepeats>



	//==========================================
	// Specify the fit

	//...................................
	// This applies a constraint on deltaM
#	<ToFit>
##		<ConstraintFunction>
#			<ExternalConstraint>
#				<Name>mistagDeltaP0_OSSS</Name>
#				<Value>-0.011</Value>
#				<Error>0.004</Error>
#			</ExternalConstraint>
#		</ConstraintFunction>
#	</ToFit>


//===============================================================================================
//===============================================================================================
//===============================================================================================
//===============================================================================================
// The commonpdf and phase space to all segments

	<CommonPDF>
		<NormalisedSumPDF>
		<FractionName>SignalFraction</FractionName>
		<PDF>
			<Name>BsMass</Name>
		</PDF>
		<PDF>
			<Name>Bs2JpsiPhiMassBkg</Name>
		</PDF>
		</NormalisedSumPDF>
	</CommonPDF>

	<CommonPhaseSpace>
		<PhaseSpaceBoundary>
			<Observable>
				<Name>mass</Name>
#				<TF1>m</TF1>
				<Minimum>5346.6</Minimum>
				<Maximum>5386.6</Maximum>
				<Unit>MeV/c^{2}</Unit>
			</Observable>
		</PhaseSpaceBoundary>
	</CommonPhaseSpace>



	//===============================================================================================
	//===============================================================================================
	//===============================================================================================
	//===============================================================================================
	// UN-TAGGED events 

	<ToFit>

		<CommonPDF>True</CommonPDF>
		<PDFConfigurator>
		</PDFConfigurator>
		<DataSet>
			<Source>File</Source>
			<FileName>/afs/cern.ch/work/d/dferguso/psi2s_selection/current/output_ntupleB_presels_data_2012.root</FileName>
			<CutString>(bdt_score>0.0)</CutString>
			<NumberEvents>10000000</NumberEvents>

			<CommonPhaseSpace>
			</CommonPhaseSpace>

		</DataSet>
	</ToFit>

<Output>
	<Projection>
		<Name>mass</Name>
		<NoLegend>True</NoLegend>
	</Projection>

</Output>

</RapidFit>

