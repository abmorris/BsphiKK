<RapidFit>
  <ParameterSet>
    # Resonance parameters
    <PhysicsParameter>
      <Name>fzeroMass</Name>
      <Value>0.9399</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>fzerogpipi</Name>
      <Value>0.1990</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>fzeroRg</Name>
      <Value>3.0</Value>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>phiMass</Name>
      <Value>1.019461</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>phiWidth</Name>
      <Value>0.004266</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ftwoMass</Name>
      <Value>1.5222</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ftwoWidth</Name>
      <Value>0.084</Value>
      <Type>Fixed</Type>
      <Unit>GeV</Unit>
    </PhysicsParameter>
    # Scale factors for each component
    <PhysicsParameter>
      <Name>NonResFrac</Name>
      <Value>0.1</Value>
      <Minimum>0.0</Minimum>
      <Maximum>0.15</Maximum>
      <Type>Float</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>SwaveFrac</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Float</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>PwaveFrac</Name>
      <Value>1.0</Value> # Fix 1
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>DwaveFrac</Name>
      <Value>2.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>10.0</Maximum>
      <Type>Float</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    # Magnitudes squared
    <PhysicsParameter>
      <Name>APperp2</Name>
      <Value>0.305</Value> # 0.305 Sean
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APzero2</Name>
      <Value>0.364</Value> # 0.364 Sean
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADperp2</Name>
      <Value>0.2595</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADzero2</Name>
      <Value>0.481</Value> # 0.481 J/psi KK
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    # Phases
    <PhysicsParameter>
      <Name>deltaSzero</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPperp</Name>
      <Value>2.67</Value> # 2.67 Sean
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPzero</Name>
      <Value>0.0</Value> # Fix 0
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPpara</Name>
      <Value>2.54</Value> # 2.54 Sean
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDperp</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDzero</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDpara</Name>
      <Value>0.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>6.3</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
  </ParameterSet>
  
  <ToFit>
    # Choose the PDF
    <PDF>
      <Name>Bs2PhiKKSignal</Name>
      <ConfigurationParameter>RBs:3.1</ConfigurationParameter>
      <ConfigurationParameter>RKK:3.1</ConfigurationParameter>
      <ConfigurationParameter>FloatResPars:True</ConfigurationParameter>
      <ConfigurationParameter>DrawComponents:True</ConfigurationParameter>
      <ConfigurationParameter>DrawNonRes:True</ConfigurationParameter>
      <ConfigurationParameter>DrawSwave:True</ConfigurationParameter>
      <ConfigurationParameter>DrawPwave:True</ConfigurationParameter>
      <ConfigurationParameter>DrawPwaveComponents:False</ConfigurationParameter>
      <ConfigurationParameter>DrawDwave:True</ConfigurationParameter>
      <ConfigurationParameter>DrawDwaveComponents:False</ConfigurationParameter>
      <ConfigurationParameter>DrawInterference:True</ConfigurationParameter>
#      <ConfigurationParameter>CoefficientsFile:/afs/cern.ch/work/a/admorris/public/BsphiKK/fits/LegendreMoments_Acceptance.root</ConfigurationParameter>
    </PDF>
    <DataSet>
      <Source>File</Source>
      <FileName>/afs/cern.ch/work/a/admorris/public/BsphiKK/ntuples/BsphiKK_data_mvaVars_vetoes_Sweighted.root</FileName>
      <CutString>B_s0_LOKI_Mass>5326.12&&5406.56>B_s0_LOKI_Mass</CutString>
#      <CutString>B_s0_LOKI_Mass>5250&&5500>B_s0_LOKI_Mass</CutString>
      <NTuplePath>DecayTree</NTuplePath>
      <NumberEvents>10000</NumberEvents>
      <PhaseSpaceBoundary>
        <Observable>
          <Name>mKK</Name>
          <TF1>BCON_KK_M_GeV</TF1>
          <Minimum>0.988</Minimum>
          <Maximum>3.000</Maximum>
          <Unit>GeV</Unit>
        </Observable>
        <Observable>
          <Name>phi</Name>
          <TF1>BCON_Phi_angle</TF1>
          <Minimum>-3.14159</Minimum>
          <Maximum>3.14159</Maximum>
          <Unit>rad</Unit>
        </Observable>
        <Observable>
          <Name>ctheta_1</Name>
          <TF1>BCON_cos_theta1</TF1>
          <Minimum>-1.0</Minimum>
          <Maximum>1.0</Maximum>
          <Unit>Unitless</Unit>
        </Observable>
        <Observable>
          <Name>ctheta_2</Name>
          <TF1>BCON_cos_theta2</TF1>
          <Minimum>-1.0</Minimum>
          <Maximum>1.0</Maximum>
          <Unit>Unitless</Unit>
        </Observable>
        <Observable>
          <Name>sWeight</Name>
          <TF1>Nsig_sw</TF1>
          <Minimum>-1.0</Minimum>
          <Maximum>1.2</Maximum>
          <Unit>Unitless</Unit>
        </Observable>
      </PhaseSpaceBoundary>
    </DataSet>
  </ToFit>
  
</RapidFit>
