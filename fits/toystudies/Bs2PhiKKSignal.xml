<RapidFit>
// Bs_phiphi=CDFAmp,DecProdCut,hpt400.dec
// βs  η   |A‖|    δ‖   |A0|   δ0   |A⊥|    δ⊥
//  0  1  0.536  2.71  0.590  0.0  0.604  2.39
//Input:  A‖ = 0.536 × Exp(i × 2.71)   A⊥ = 0.604 × Exp(i × 2.39)
//Output:  A+ = 0.796 × Exp(i × 2.54)   A− = 0.137 × Exp(i × -1.81)
  <ParameterSet>
    // Scale factors for each component
    <PhysicsParameter>
      <Name>SwaveFrac</Name>
      <Value>0.01</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>PwaveFrac</Name>
      <Value>1.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>DwaveFrac</Name>
      <Value>1.0</Value>
      <Minimum>0.0</Minimum>
      <Maximum>10.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    // Magnitudes squared
    <PhysicsParameter>
      <Name>APperp2</Name>
      <Value>0.365</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>APzero2</Name>
      <Value>0.348</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADperp2</Name>
      <Value>0.365</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>ADzero2</Name>
      <Value>0.348</Value>
      <Minimum>0.0</Minimum>
      <Maximum>1.0</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    // Phases
    <PhysicsParameter>
      <Name>deltaSzero</Name>
      <Value>0</Value>
      <Minimum>-3.14159</Minimum>
      <Maximum>3.14159</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPperp</Name>
      <Value>2.39</Value>
      <Minimum>-3.14159</Minimum>
      <Maximum>3.14159</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPzero</Name>
      <Value>0.0</Value>
      <Minimum>-3.1415927</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaPpara</Name>
      <Value>2.71</Value>
      <Minimum>0</Minimum>
      <Maximum>6.5</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDperp</Name>
      <Value>2.39</Value>
      <Minimum>-3.14159</Minimum>
      <Maximum>3.14159</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDzero</Name>
      <Value>0.0</Value>
      <Minimum>-3.1415927</Minimum>
      <Maximum>3.1415927</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
    <PhysicsParameter>
      <Name>deltaDpara</Name>
      <Value>2.71</Value>
      <Minimum>0</Minimum>
      <Maximum>6.5</Maximum>
      <Type>Fixed</Type>
      <Unit>Unitless</Unit>
    </PhysicsParameter>
  </ParameterSet>
  // Choose the minimiser
  <Minimiser>
    <MinimiserName>Minuit</MinimiserName>
  </Minimiser>
  // Choose the fit function
  <FitFunction>
    <FunctionName>NegativeLogLikelihoodNumerical</FunctionName>
    <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
    <FixedIntegrationPoints>1000</FixedIntegrationPoints>
    <Threads>16</Threads>
  </FitFunction>
  <CommonPhaseSpace>
    <PhaseSpaceBoundary>
      <Observable>
        <Name>mKK</Name>
        <Minimum>990</Minimum>
        <Maximum>1800</Maximum>
        <Unit>MeV/c^2</Unit>
      </Observable>
      <Observable>
        <Name>phi</Name>
        <Minimum>-3.14159</Minimum>
        <Maximum>3.14159</Maximum>
        <Unit>rad</Unit>
      </Observable>
      <Observable>
        <Name>ctheta_1</Name>
        <Minimum>-1.0</Minimum>
        <Maximum>1.0</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
      <Observable>
        <Name>ctheta_2</Name>
        <Minimum>-1.0</Minimum>
        <Maximum>1.0</Maximum>
        <Unit>Unitless</Unit>
      </Observable>
    </PhaseSpaceBoundary>
  </CommonPhaseSpace>
  
  <ToFit>
    // Choose the PDF
      <PDF>
        <Name>Bs2PhiKKSignal</Name>
        <ConfigurationParameter>DrawComponents:True</ConfigurationParameter>
        <ConfigurationParameter>DrawSwave:True</ConfigurationParameter>
        <ConfigurationParameter>DrawPwave:True</ConfigurationParameter>
        <ConfigurationParameter>DrawDwave:True</ConfigurationParameter>
        <ConfigurationParameter>DrawInterference:True</ConfigurationParameter>
      </PDF>
    <DataSet>
      <Source>Foam</Source>
      <NumberEvents>100000</NumberEvents>
      <CommonPhaseSpace>
      </CommonPhaseSpace>
    </DataSet>
  </ToFit>
  <Output>
    <ComponentProjection>
      <Name>mKK</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>1000</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>True</DrawPull>
      <Ymin>-500</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>phi</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>100</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>True</DrawPull>
      <Ymin>-500</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_1</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>100</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>True</DrawPull>
      <Ymin>-500</Ymin>
    </ComponentProjection>
    <ComponentProjection>
      <Name>ctheta_2</Name>
      <FixedIntegrationPoints>1000</FixedIntegrationPoints>
      <UseGSLNumericalIntegration>True</UseGSLNumericalIntegration>
      <PDFpoints>100</PDFpoints>
      <Threads>16</Threads>
      <DrawPull>True</DrawPull>
      <Ymin>-500</Ymin>
    </ComponentProjection>
  </Output>
</RapidFit>
